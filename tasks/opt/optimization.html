<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Geometry Optimization - MAPLE</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../../index.html"><img src="../../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../general.html">About</a></li>
          <li><a href="../../documentation.html">Documentation</a></li>
          <li><a href="../../articles.html">Articles</a></li>
          <li><a href="../../downloads.html">Downloads</a></li>
          <li><a href="../../development.html">Development</a></li>
          <li><a href="../../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../../tutorials/installation.html">Installation</a></li>
                <li><a href="../../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../../setup/settings.html">Settings</a></li>
                <li><a href="../../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../../tasks/frequency.html">Frequency</a></li>
                <li class="open">
                  <span class="tree-label"><span class="chevron"></span> <a href="optimization.html" class="active">Optimization</a></span>
                  <ul class="children">
                    <li><a href="opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="opt_rfo.html">RFO</a></li>
                    <li><a href="opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../ts/ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="../ts/ts_prfo.html">P-RFO</a></li>
                    <li><a href="../ts/ts_neb.html">NEB</a></li>
                    <li><a href="../ts/ts_dimmer.html">Dimer</a></li>
                    <li><a href="../ts/ts_string.html">String/GSM</a></li>
                    <li><a href="../ts/ts_autoneb.html">AutoNEB</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../scan/scan.html">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="../scan/scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../scan/scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../irc/irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="../irc/irc_gs.html">GS</a></li>
                    <li><a href="../irc/irc_lqa.html">LQA</a></li>
                    <li><a href="../irc/irc_hpc.html">HPC</a></li>
                    <li><a href="../irc/irc_eulerpc.html">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../../functions/solvent.html">Solvation</a></li>
                <li><a href="../../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <article>
        <nav class="breadcrumb" aria-label="Breadcrumb">
          <a href="../../index.html">Home</a>
          <span class="separator">/</span>
          <a href="../../documentation.html">Docs</a>
          <span class="separator">/</span>
          <a href="../../documentation.html">Tasks</a>
          <span class="separator">/</span>
          <span class="current">Optimization</span>
        </nav>

        <h1>Geometry Optimization</h1>

        <h2 id="overview">Overview</h2>
        <p>Geometry optimization minimizes the molecular energy by iteratively adjusting nuclear positions until the forces acting on all atoms fall below predefined convergence thresholds. Starting from an initial structure, the optimizer walks downhill on the potential energy surface to locate the nearest local minimum.</p>
        <p>MAPLE provides several optimization algorithms suited to different problem types, ranging from efficient quasi-Newton methods to simple gradient-based approaches. The default optimizer, L-BFGS, is appropriate for the vast majority of systems.</p>

        <h2 id="available-methods">Available Methods</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Method</th>
                <th>Keyword</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="opt_lbfgs.html"><strong>L-BFGS</strong></a></td>
                <td><code>lbfgs</code></td>
                <td>Limited-memory BFGS quasi-Newton method. <strong>Default and recommended</strong> for most systems.</td>
              </tr>
              <tr>
                <td><a href="opt_rfo.html"><strong>RFO</strong></a></td>
                <td><code>rfo</code></td>
                <td>Rational Function Optimization with trust radius control. More robust for difficult cases.</td>
              </tr>
              <tr>
                <td><a href="opt_sd.html"><strong>SD</strong></a></td>
                <td><code>sd</code></td>
                <td>Steepest descent. Simplest first-order method; follows the negative gradient.</td>
              </tr>
              <tr>
                <td><strong>CG</strong></td>
                <td><code>cg</code></td>
                <td>Conjugate gradient. Improved convergence over SD with minimal additional cost.</td>
              </tr>
              <tr>
                <td><strong>SDCG</strong></td>
                <td><code>sdcg</code></td>
                <td>Hybrid steepest-descent / conjugate-gradient. Starts with SD, switches to CG automatically.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h2 id="quick-usage">Quick Usage</h2>
        <p>To run a geometry optimization, add the <code>#opt</code> directive to your input file. The method can be specified in parentheses:</p>
        <pre><code>#opt(method=lbfgs)</code></pre>
        <p>If no method is specified, L-BFGS is used by default:</p>
        <pre><code>#opt</code></pre>

        <h2 id="input-example">Input Example</h2>
        <p>A complete input file for a geometry optimization using the UMA model on a GPU device:</p>
        <pre><code>#model=uma
#opt(method=lbfgs)
#device=gpu0

[coordinates]
O    0.000000    0.000000    0.117300
H    0.000000    0.756950   -0.469200
H    0.000000   -0.756950   -0.469200</code></pre>

        <h2 id="common-parameters">Common Parameters</h2>
        <p>These parameters are shared across all optimization methods. Individual methods may accept additional method-specific parameters.</p>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Default</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>method</code></td>
                <td><code>lbfgs</code></td>
                <td>Optimization algorithm to use (see table above).</td>
              </tr>
              <tr>
                <td><code>level</code></td>
                <td><code>medium</code></td>
                <td>Convergence level preset. Options: <code>extratight</code>, <code>tight</code>, <code>medium</code> (default), <code>loose</code>, <code>extraloose</code>, <code>superloose</code>.</td>
              </tr>
              <tr>
                <td><code>max_iter</code></td>
                <td><code>256</code></td>
                <td>Maximum number of optimization cycles before the calculation is terminated.</td>
              </tr>
              <tr>
                <td><code>write_traj</code></td>
                <td><code>false</code></td>
                <td>Write intermediate geometries to a trajectory file.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h2 id="output-files">Output Files</h2>
        <p>A successful optimization produces the following output files:</p>
        <ul>
          <li><strong><code>*_opt.xyz</code></strong> &mdash; The final optimized geometry in XYZ format. This is the primary result file.</li>
          <li><strong><code>*_traj.xyz</code></strong> &mdash; The full optimization trajectory containing the geometry at each iteration (only produced when <code>write_traj=true</code>). Useful for visualizing the optimization path in molecular viewers.</li>
          <li><strong><code>*.out</code></strong> &mdash; The main output log containing energies, forces, convergence diagnostics, and timing information at each step.</li>
        </ul>

        <div class="admonition tip">
          <div class="admonition-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
            Tip
          </div>
          <div class="admonition-body">
            <p>For routine optimizations, the default L-BFGS method with <code>level=medium</code> is sufficient. Switch to <code>level=tight</code> when computing vibrational frequencies on the optimized geometry to ensure accurate Hessian evaluation.</p>
          </div>
        </div>

        <nav class="page-nav">
          <a href="../../tasks/frequency.html">&larr; Frequency</a>
          <a class="next" href="opt_lbfgs.html">L-BFGS &rarr;</a>
        </nav>
      </article>
    </main>

    <aside class="toc">
      <div class="toc-sticky">
        <h3>On this page</h3>
        <ul></ul>
      </div>
    </aside>
  </div>
  <div class="sidebar-overlay"></div>
  <footer><p>&copy; 2026, MAPLE development team.</p></footer>
  <script src="../../assets/js/main.js"></script>
</body>
</html>
