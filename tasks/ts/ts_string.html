<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Growing String Method (GSM) - MAPLE</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../../index.html"><img src="../../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../general.html">About</a></li>
          <li><a href="../../documentation.html">Documentation</a></li>
          <li><a href="../../articles.html">Articles</a></li>
          <li><a href="../../downloads.html">Downloads</a></li>
          <li><a href="../../development.html">Development</a></li>
          <li><a href="../../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../../tutorials/installation.html">Installation</a></li>
                <li><a href="../../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../../setup/settings.html">Settings</a></li>
                <li><a href="../../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../../tasks/frequency.html">Frequency</a></li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../opt/optimization.html">Optimization</a></span>
                  <ul class="children">
                    <li><a href="../opt/opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../opt/opt_rfo.html">RFO</a></li>
                    <li><a href="../opt/opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li class="open">
                  <span class="tree-label"><span class="chevron"></span> <a href="ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="ts_prfo.html">P-RFO</a></li>
                    <li><a href="ts_neb.html">NEB</a></li>
                    <li><a href="ts_dimmer.html">Dimer</a></li>
                    <li><a href="ts_string.html" class="active">String/GSM</a></li>
                    <li><a href="ts_autoneb.html">AutoNEB</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../scan/scan.html">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="../scan/scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../scan/scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../irc/irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="../irc/irc_gs.html">GS</a></li>
                    <li><a href="../irc/irc_lqa.html">LQA</a></li>
                    <li><a href="../irc/irc_hpc.html">HPC</a></li>
                    <li><a href="../irc/irc_eulerpc.html">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../../functions/solvent.html">Solvation</a></li>
                <li><a href="../../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <nav class="breadcrumb">
        <a href="../../index.html">Home</a>
        <span class="separator">/</span>
        <a href="../../documentation.html">Docs</a>
        <span class="separator">/</span>
        <a href="../../documentation.html">Tasks</a>
        <span class="separator">/</span>
        <a href="ts.html">Transition State</a>
        <span class="separator">/</span>
        <span class="current">String/GSM</span>
      </nav>

      <article>
        <h1>Growing String Method (GSM)</h1>

        <h2 id="overview">Overview</h2>
        <p>The Growing String Method (GSM) is an adaptive path-based algorithm for finding minimum energy paths and transition states between a given reactant and product. Unlike NEB, which creates all images at once, GSM grows the path incrementally from both endpoints, adding new nodes only where needed. This adaptive growth strategy can be significantly more efficient than NEB for large molecular systems.</p>
        <p>MAPLE's GSM implementation features Kabsch alignment of endpoints, two-ended adaptive growth with constrained mini-relaxation in the hyperplane orthogonal to the local path direction, energy-weighted tangents, a dynamic growth policy (including side pausing and forced connector pulls), and CI-STRING refinement followed by P-RFO TS optimization from the highest-energy image.</p>

        <h2 id="parameters">Parameters</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Default</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>grow_step</code></td>
                <td>float</td>
                <td>0.12</td>
                <td>Step size for growing new nodes (Angstrom).</td>
              </tr>
              <tr>
                <td><code>grow_step_min</code></td>
                <td>float</td>
                <td>0.02</td>
                <td>Minimum growing step size.</td>
              </tr>
              <tr>
                <td><code>grow_backtrack</code></td>
                <td>float</td>
                <td>0.5</td>
                <td>Backtracking factor during growth.</td>
              </tr>
              <tr>
                <td><code>grow_relax_iters</code></td>
                <td>int</td>
                <td>10</td>
                <td>Relaxation iterations after each growth step.</td>
              </tr>
              <tr>
                <td><code>grow_relax_tol</code></td>
                <td>float</td>
                <td>2.5e-3</td>
                <td>Force tolerance for growth relaxation.</td>
              </tr>
              <tr>
                <td><code>grow_energy_tol</code></td>
                <td>float</td>
                <td>1.0e-3</td>
                <td>Energy tolerance for growth relaxation (Eh).</td>
              </tr>
              <tr>
                <td><code>pause_imbalance</code></td>
                <td>int</td>
                <td>2</td>
                <td>Pause growth from one end if it leads the other by this many nodes.</td>
              </tr>
              <tr>
                <td><code>refine_end_every</code></td>
                <td>int</td>
                <td>3</td>
                <td>Re-optimize endpoint images every N growth steps.</td>
              </tr>
              <tr>
                <td><code>merge_threshold</code></td>
                <td>float</td>
                <td>0.5</td>
                <td>Distance threshold for merging approaching fronts (Angstrom).</td>
              </tr>
              <tr>
                <td><code>n_images</code></td>
                <td>int</td>
                <td>9</td>
                <td>Target number of string images.</td>
              </tr>
              <tr>
                <td><code>max_iter_relax</code></td>
                <td>int</td>
                <td>300</td>
                <td>Maximum iterations for full string relaxation.</td>
              </tr>
              <tr>
                <td><code>string_f_max_th</code></td>
                <td>float</td>
                <td>5.0e-3</td>
                <td>Max force convergence threshold for string.</td>
              </tr>
              <tr>
                <td><code>string_f_rms_th</code></td>
                <td>float</td>
                <td>1.0e-3</td>
                <td>RMS force convergence threshold for string.</td>
              </tr>
              <tr>
                <td><code>lbfgs_memory</code></td>
                <td>int</td>
                <td>7</td>
                <td>L-BFGS memory for string relaxation.</td>
              </tr>
              <tr>
                <td><code>lbfgs_curvature</code></td>
                <td>float</td>
                <td>70.0</td>
                <td>L-BFGS initial curvature estimate.</td>
              </tr>
              <tr>
                <td><code>lbfgs_max_step</code></td>
                <td>float</td>
                <td>0.2</td>
                <td>L-BFGS maximum step.</td>
              </tr>
              <tr>
                <td><code>reparam_every</code></td>
                <td>int</td>
                <td>3</td>
                <td>Reparametrize string every N iterations.</td>
              </tr>
              <tr>
                <td><code>refine</code></td>
                <td>str</td>
                <td>None</td>
                <td>Post-string refinement: None, "cistring", or "stringts".</td>
              </tr>
              <tr>
                <td><code>cistring_f_max_th</code></td>
                <td>float</td>
                <td>4.0e-3</td>
                <td>Max force threshold for CI-String refinement.</td>
              </tr>
              <tr>
                <td><code>cistring_f_rms_th</code></td>
                <td>float</td>
                <td>2.0e-3</td>
                <td>RMS force threshold for CI-String refinement.</td>
              </tr>
              <tr>
                <td><code>max_iter_grow</code></td>
                <td>int</td>
                <td>100</td>
                <td>Maximum iterations for the growing phase.</td>
              </tr>
              <tr>
                <td><code>log_every</code></td>
                <td>int</td>
                <td>1</td>
                <td>Log progress every N iterations.</td>
              </tr>
              <tr>
                <td><code>guide_conn_min</code></td>
                <td>float</td>
                <td>0.3</td>
                <td>Minimum connectivity for geodesic guiding.</td>
              </tr>
              <tr>
                <td><code>guide_d_switch</code></td>
                <td>float</td>
                <td>4.0</td>
                <td>Distance switch for geodesic guidance.</td>
              </tr>
              <tr>
                <td><code>guide_inc_trigger</code></td>
                <td>int</td>
                <td>2</td>
                <td>Trigger for increasing guidance strength.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h2 id="input-example">Input Example</h2>
        <pre><code>#model=ani1xnr
#ts(method=string,refine=stringts)
#device=gpu0

XYZ /path/to/reactant.xyz
XYZ /path/to/product.xyz</code></pre>

        <h2 id="output">Output</h2>
        <ul>
          <li><code>*_gsm_grow_final.xyz</code> &mdash; The final path after the growth phase is complete, before reparameterization and refinement.</li>
          <li><code>*_gsm_mep.xyz</code> &mdash; The reparameterized minimum energy path with equally spaced images.</li>
          <li><code>*_stringts_ts.xyz</code> &mdash; The final optimized TS geometry obtained from P-RFO refinement of the highest-energy image along the string.</li>
        </ul>

        <h2 id="comparison-with-neb">Comparison with NEB</h2>
        <p>Both GSM and NEB are path-based methods that require reactant and product endpoints. The key differences are:</p>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Aspect</th>
                <th>NEB</th>
                <th>String/GSM</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Path construction</td>
                <td>All images created at once via interpolation</td>
                <td>Images grown adaptively from both ends</td>
              </tr>
              <tr>
                <td>Computational cost</td>
                <td>All images evaluated at every iteration</td>
                <td>Only frontier images evaluated during growth</td>
              </tr>
              <tr>
                <td>Large systems</td>
                <td>Can be expensive due to many simultaneous images</td>
                <td>More efficient; fewer evaluations needed during growth</td>
              </tr>
              <tr>
                <td>Path resolution</td>
                <td>Uniform resolution along entire path</td>
                <td>Adaptive resolution; concentrates images where needed</td>
              </tr>
              <tr>
                <td>Robustness</td>
                <td>Well-established; generally robust</td>
                <td>Can stall for very large structural differences</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p>For small to medium systems with modest structural changes, NEB and GSM typically perform comparably. For large systems (hundreds of atoms) or reactions with large geometric rearrangements, GSM's adaptive growth can provide significant computational savings.</p>

        <nav class="page-nav">
          <a href="ts_dimmer.html">&larr; Previous: Dimer</a>
          <a class="next" href="ts_autoneb.html">Next: AutoNEB &rarr;</a>
        </nav>
      </article>
    </main>

    <aside class="toc"><div class="toc-sticky"><h3>On this page</h3><ul></ul></div></aside>
  </div>
  <div class="sidebar-overlay"></div>
  <footer><p>&copy; 2026, MAPLE development team.</p></footer>
  <script src="../../assets/js/main.js"></script>
</body>
</html>
