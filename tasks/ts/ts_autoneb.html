<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AutoNEB (Automated NEB) - MAPLE</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../../index.html"><img src="../../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../general.html">About</a></li>
          <li><a href="../../documentation.html">Documentation</a></li>
          <li><a href="../../articles.html">Articles</a></li>
          <li><a href="../../downloads.html">Downloads</a></li>
          <li><a href="../../development.html">Development</a></li>
          <li><a href="../../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../../tutorials/installation.html">Installation</a></li>
                <li><a href="../../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../../setup/settings.html">Settings</a></li>
                <li><a href="../../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../../tasks/frequency.html">Frequency</a></li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../opt/optimization.html">Optimization</a></span>
                  <ul class="children">
                    <li><a href="../opt/opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../opt/opt_rfo.html">RFO</a></li>
                    <li><a href="../opt/opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li class="open">
                  <span class="tree-label"><span class="chevron"></span> <a href="ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="ts_prfo.html">P-RFO</a></li>
                    <li><a href="ts_neb.html">NEB</a></li>
                    <li><a href="ts_dimmer.html">Dimer</a></li>
                    <li><a href="ts_string.html">String/GSM</a></li>
                    <li><a href="ts_autoneb.html" class="active">AutoNEB</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../scan/scan.html">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="../scan/scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../scan/scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../irc/irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="../irc/irc_gs.html">GS</a></li>
                    <li><a href="../irc/irc_lqa.html">LQA</a></li>
                    <li><a href="../irc/irc_hpc.html">HPC</a></li>
                    <li><a href="../irc/irc_eulerpc.html">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../../functions/solvent.html">Solvation</a></li>
                <li><a href="../../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <nav class="breadcrumb">
        <a href="../../index.html">Home</a>
        <span class="separator">/</span>
        <a href="../../documentation.html">Docs</a>
        <span class="separator">/</span>
        <a href="../../documentation.html">Tasks</a>
        <span class="separator">/</span>
        <a href="ts.html">Transition State</a>
        <span class="separator">/</span>
        <span class="current">AutoNEB</span>
      </nav>

      <article>
        <h1>AutoNEB (Automated NEB)</h1>

        <h2 id="overview">Overview</h2>
        <p>AutoNEB is an automated multi-step NEB workflow designed for complex reactions that involve multiple intermediates and transition states. Rather than requiring the user to manually identify each elementary step, AutoNEB recursively subdivides the reaction path between a given reactant and product, automatically discovering all stationary points along the way.</p>
        <p>This method is particularly valuable for multi-step reaction mechanisms where the number and nature of intermediates are not known in advance. AutoNEB handles the entire workflow automatically: running NEB calculations, identifying intermediates, and recursively refining each segment of the path until all transition states and intermediates have been located.</p>

        <h2 id="how-it-works">How It Works</h2>
        <p>The AutoNEB algorithm proceeds through the following stages:</p>
        <ol>
          <li><strong>Initial NEB.</strong> A standard NEB calculation is performed between the overall reactant and product structures, producing an initial minimum energy path.</li>
          <li><strong>Identify highest-energy images.</strong> The highest-energy images (HEIs) along the converged path are identified as candidate transition states. Images in local energy minima along the path are identified as candidate intermediates.</li>
          <li><strong>Optimize intermediates.</strong> Candidate intermediate structures are optimized to true local minima using geometry optimization.</li>
          <li><strong>Recursive subdivision.</strong> New NEB calculations are launched between each pair of adjacent stationary points (minima). This process repeats recursively, building a tree of NEB calculations that progressively resolves the full reaction mechanism.</li>
          <li><strong>Collect results.</strong> All transition state and intermediate structures are collected into a unified global MEP. The recursion terminates when no new intermediates are found in any segment, or when the maximum tree depth is reached.</li>
        </ol>

        <h2 id="parameters">Parameters</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Default</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>n_images</code></td>
                <td>int</td>
                <td>20</td>
                <td>Number of initial NEB images.</td>
              </tr>
              <tr>
                <td><code>k_min</code></td>
                <td>float</td>
                <td>0.03</td>
                <td>Minimum spring constant (Eh/Ang&sup2;).</td>
              </tr>
              <tr>
                <td><code>k_max</code></td>
                <td>float</td>
                <td>0.3</td>
                <td>Maximum spring constant (Eh/Ang&sup2;).</td>
              </tr>
              <tr>
                <td><code>use_dynamic_k</code></td>
                <td>bool</td>
                <td>True</td>
                <td>Enable dynamic spring constants.</td>
              </tr>
              <tr>
                <td><code>k_decay</code></td>
                <td>float</td>
                <td>0.5</td>
                <td>Dynamic spring constant decay factor.</td>
              </tr>
              <tr>
                <td><code>max_iter</code></td>
                <td>int</td>
                <td>256</td>
                <td>Maximum NEB iterations per sub-path.</td>
              </tr>
              <tr>
                <td><code>lbfgs_m</code></td>
                <td>int</td>
                <td>10</td>
                <td>L-BFGS memory for band optimization.</td>
              </tr>
              <tr>
                <td><code>step0</code></td>
                <td>float</td>
                <td>2e-2</td>
                <td>Initial L-BFGS step size.</td>
              </tr>
              <tr>
                <td><code>ifidpp</code></td>
                <td>int</td>
                <td>1</td>
                <td>IDPP interpolation flag (1=IDPP, 0=linear).</td>
              </tr>
              <tr>
                <td><code>ang_max</code></td>
                <td>float</td>
                <td>0.3</td>
                <td>Max distance between adjacent images (Angstrom).</td>
              </tr>
              <tr>
                <td><code>ang_iter</code></td>
                <td>int</td>
                <td>20</td>
                <td>Check for image insertion every N iterations.</td>
              </tr>
              <tr>
                <td><code>path_iter</code></td>
                <td>int</td>
                <td>50</td>
                <td>Check for local minima every N iterations.</td>
              </tr>
              <tr>
                <td><code>min_e_drop</code></td>
                <td>float</td>
                <td>0.001</td>
                <td>Energy drop threshold for minima detection (Eh).</td>
              </tr>
              <tr>
                <td><code>ep_iter</code></td>
                <td>int</td>
                <td>30</td>
                <td>Check endpoint updates every N iterations.</td>
              </tr>
              <tr>
                <td><code>ep_e_drop</code></td>
                <td>float</td>
                <td>0.0005</td>
                <td>Energy drop for endpoint update (Eh).</td>
              </tr>
              <tr>
                <td><code>autoneb_f_max_th</code></td>
                <td>float</td>
                <td>9.5e-3</td>
                <td>Max force convergence threshold.</td>
              </tr>
              <tr>
                <td><code>autoneb_f_rms_th</code></td>
                <td>float</td>
                <td>5e-3</td>
                <td>RMS force convergence threshold.</td>
              </tr>
              <tr>
                <td><code>max_depth</code></td>
                <td>int</td>
                <td>5</td>
                <td>Maximum recursion depth for path subdivision.</td>
              </tr>
              <tr>
                <td><code>max_paths</code></td>
                <td>int</td>
                <td>10</td>
                <td>Maximum number of sub-paths.</td>
              </tr>
              <tr>
                <td><code>do_final_refine</code></td>
                <td>bool</td>
                <td>True</td>
                <td>Perform final CI-NEB refinement.</td>
              </tr>
              <tr>
                <td><code>final_refine_factor</code></td>
                <td>float</td>
                <td>2.0</td>
                <td>Image density factor for final refinement.</td>
              </tr>
              <tr>
                <td><code>final_refine_max_iter</code></td>
                <td>int</td>
                <td>200</td>
                <td>Max iterations for final refinement.</td>
              </tr>
              <tr>
                <td><code>final_refine_ep_iter</code></td>
                <td>int</td>
                <td>20</td>
                <td>Endpoint check interval during final refinement.</td>
              </tr>
              <tr>
                <td><code>verbose</code></td>
                <td>int</td>
                <td>1</td>
                <td>Output verbosity level.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h2 id="input-example">Input Example</h2>
        <pre><code>#model=ani1xnr
#ts(method=autoneb)
#device=gpu0

XYZ /path/to/reactant.xyz
XYZ /path/to/product.xyz</code></pre>

        <h2 id="output-files">Output Files</h2>
        <ul>
          <li><code>*_autoneb_global_mep.xyz</code> &mdash; The complete global minimum energy path spanning all elementary steps, from the initial reactant through all intermediates to the final product.</li>
          <li><code>*_autoneb_intermediates.xyz</code> &mdash; Optimized geometries of all intermediate structures discovered during the recursive search.</li>
          <li><code>*_autoneb_ts_list.xyz</code> &mdash; All transition state geometries found across every segment of the reaction mechanism.</li>
          <li><code>*_autoneb_path_*.xyz</code> &mdash; Individual MEP files for each NEB segment in the recursive tree (numbered sequentially).</li>
          <li><code>*_autoneb_tree.json</code> &mdash; JSON file describing the recursion tree structure, including parent-child relationships between NEB segments, energies, and convergence status.</li>
        </ul>

        <div class="admonition tip">
          <div class="admonition-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
            Tip
          </div>
          <div class="admonition-body">
            <p>AutoNEB is ideal for reactions with multiple intermediates, such as enzyme mechanisms, catalytic cycles, or multi-step organic transformations. If you suspect your reaction has more than one elementary step, AutoNEB can discover the full mechanism automatically without requiring you to guess the intermediates.</p>
          </div>
        </div>

        <div class="admonition warning">
          <div class="admonition-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            Warning
          </div>
          <div class="admonition-body">
            <p>AutoNEB can be computationally expensive for deep reaction networks. Each level of recursion spawns additional NEB calculations, and the total cost grows with the number of elementary steps discovered. For very complex mechanisms, consider limiting <code>max_depth</code> or using a smaller <code>n_images</code> value for the initial exploration, then refining specific segments with higher resolution.</p>
          </div>
        </div>

        <nav class="page-nav">
          <a href="ts_string.html">&larr; Previous: String/GSM</a>
          <a class="next" href="../scan/scan.html">Next: PES Scan &rarr;</a>
        </nav>
      </article>
    </main>

    <aside class="toc"><div class="toc-sticky"><h3>On this page</h3><ul></ul></div></aside>
  </div>
  <div class="sidebar-overlay"></div>
  <footer><p>&copy; 2026, MAPLE development team.</p></footer>
  <script src="../../assets/js/main.js"></script>
</body>
</html>
