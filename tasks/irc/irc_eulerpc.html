<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IRC: Euler Predictor-Corrector (EulerPC) - MAPLE</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../../index.html"><img src="../../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../general.html">About</a></li>
          <li><a href="../../documentation.html">Documentation</a></li>
          <li><a href="../../articles.html">Articles</a></li>
          <li><a href="../../downloads.html">Downloads</a></li>
          <li><a href="../../development.html">Development</a></li>
          <li><a href="../../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../../tutorials/installation.html">Installation</a></li>
                <li><a href="../../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../../setup/settings.html">Settings</a></li>
                <li><a href="../../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../../tasks/frequency.html">Frequency</a></li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../opt/optimization.html">Optimization</a></span>
                  <ul class="children">
                    <li><a href="../opt/opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../opt/opt_rfo.html">RFO</a></li>
                    <li><a href="../opt/opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../ts/ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="../ts/ts_prfo.html">P-RFO</a></li>
                    <li><a href="../ts/ts_neb.html">NEB</a></li>
                    <li><a href="../ts/ts_dimmer.html">Dimer</a></li>
                    <li><a href="../ts/ts_string.html">String/GSM</a></li>
                    <li><a href="../ts/ts_autoneb.html">AutoNEB</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../scan/scan.html">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="../scan/scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../scan/scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li class="open">
                  <span class="tree-label"><span class="chevron"></span> <a href="irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="irc_gs.html">GS</a></li>
                    <li><a href="irc_lqa.html">LQA</a></li>
                    <li><a href="irc_hpc.html">HPC</a></li>
                    <li><a href="irc_eulerpc.html" class="active">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../../functions/solvent.html">Solvation</a></li>
                <li><a href="../../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../documentation.html">Docs</a></li>
          <li><a href="../../documentation.html">Tasks</a></li>
          <li><a href="irc.html">IRC</a></li>
          <li aria-current="page">EulerPC</li>
        </ol>
      </nav>

      <article>
        <h1>IRC: Euler Predictor&ndash;Corrector (EulerPC)</h1>

        <h2 id="overview">Overview</h2>
        <p>The Euler Predictor&ndash;Corrector (EulerPC) method is the simplest predictor-corrector IRC integrator available in MAPLE. It uses a basic Euler integration step (following the negative gradient direction) as the predictor, then applies a corrector step to project the path back onto the true minimum energy path. While EulerPC is generally slower than the other IRC methods due to smaller effective step sizes, it is the most robust option for difficult potential energy surfaces where higher-order methods may fail to converge.</p>

        <h2 id="algorithm">Algorithm</h2>
        <p>At each IRC step, the EulerPC method proceeds in two phases:</p>
        <ol>
          <li><strong>Predictor (Euler step)</strong> &mdash; A simple Euler integration step is taken along the negative gradient direction in mass-weighted coordinates. The step length is controlled by the <code>step_length_bohr</code> parameter. This produces a trial point that approximately follows the steepest-descent path.</li>
          <li><strong>Corrector (gradient projection)</strong> &mdash; The actual gradient is evaluated at the trial point, and a correction is applied to project the geometry back onto the minimum energy path. This correction uses bisection or gradient-based projection to ensure the corrected point lies on the true IRC path rather than drifting off due to the finite step size of the Euler predictor.</li>
        </ol>
        <p>Because the Euler predictor is only first-order accurate, smaller step sizes are typically needed compared to LQA or HPC to maintain path accuracy. However, the simplicity of the algorithm means it makes no assumptions about PES smoothness or curvature, giving it superior robustness on highly anharmonic or irregular surfaces.</p>

        <h2 id="parameters">Parameters</h2>
        <p>The complete <code>EulerPCParams</code> dataclass:</p>
        <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Parameter</th>
              <th>Type</th>
              <th>Default</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>target_mode</code></td>
              <td>int</td>
              <td>1</td>
              <td>Index of the imaginary mode to follow.</td>
            </tr>
            <tr>
              <td><code>step_length_bohr</code></td>
              <td>float</td>
              <td>0.10</td>
              <td>Step length in Bohr.</td>
            </tr>
            <tr>
              <td><code>max_steps</code></td>
              <td>int</td>
              <td>50</td>
              <td>Maximum IRC steps per direction.</td>
            </tr>
            <tr>
              <td><code>max_pred_steps</code></td>
              <td>int</td>
              <td>500</td>
              <td>Maximum predictor sub-steps.</td>
            </tr>
            <tr>
              <td><code>loose_cycles</code></td>
              <td>int</td>
              <td>3</td>
              <td>Number of initial cycles with loosened convergence.</td>
            </tr>
            <tr>
              <td><code>hessian_recalc</code></td>
              <td>int</td>
              <td>None</td>
              <td>Recalculate Hessian every N steps.</td>
            </tr>
            <tr>
              <td><code>hessian_update</code></td>
              <td>str</td>
              <td><code>"bofill"</code></td>
              <td>Hessian update: <code>"bfgs"</code> or <code>"bofill"</code>.</td>
            </tr>
            <tr>
              <td><code>dwi_n</code></td>
              <td>int</td>
              <td>4</td>
              <td>Distance-weighted interpolation points.</td>
            </tr>
            <tr>
              <td><code>mbs_max_k</code></td>
              <td>int</td>
              <td>15</td>
              <td>Max polynomial order for MBS.</td>
            </tr>
            <tr>
              <td><code>mbs_points</code></td>
              <td>int</td>
              <td>20</td>
              <td>Number of MBS integration points.</td>
            </tr>
            <tr>
              <td><code>mbs_tol</code></td>
              <td>float</td>
              <td>1e-5</td>
              <td>MBS convergence tolerance.</td>
            </tr>
            <tr>
              <td><code>f_max_th</code></td>
              <td>float</td>
              <td>2e-3</td>
              <td>Max force convergence threshold.</td>
            </tr>
            <tr>
              <td><code>f_rms_th</code></td>
              <td>float</td>
              <td>5e-4</td>
              <td>RMS force convergence threshold.</td>
            </tr>
            <tr>
              <td><code>print_each</code></td>
              <td>bool</td>
              <td>True</td>
              <td>Print details at each IRC point.</td>
            </tr>
            <tr>
              <td><code>write_traj</code></td>
              <td>bool</td>
              <td>True</td>
              <td>Write trajectory XYZ files.</td>
            </tr>
          </tbody>
        </table>
        </div>

        <h2 id="input-example">Input Example</h2>
        <pre><code>#model=ani1xnr
#irc(method=eulerpc)
#device=gpu0

XYZ /path/to/transition_state.xyz</code></pre>

        <h2 id="comparison-of-irc-methods">Comparison of IRC Methods</h2>
        <table>
          <thead>
            <tr>
              <th>Method</th>
              <th>Speed</th>
              <th>Robustness</th>
              <th>Best For</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong><a href="irc_gs.html">GS</a></strong></td>
              <td>Moderate</td>
              <td>High</td>
              <td>General use (default)</td>
            </tr>
            <tr>
              <td><strong><a href="irc_lqa.html">LQA</a></strong></td>
              <td>Fast</td>
              <td>Moderate</td>
              <td>Smooth surfaces</td>
            </tr>
            <tr>
              <td><strong><a href="irc_hpc.html">HPC</a></strong></td>
              <td>Fast</td>
              <td>High</td>
              <td>Balanced speed/accuracy</td>
            </tr>
            <tr>
              <td><strong>EulerPC</strong></td>
              <td>Slow</td>
              <td>Very High</td>
              <td>Difficult/anharmonic surfaces</td>
            </tr>
          </tbody>
        </table>

        <h2 id="when-to-use">When to Use</h2>
        <p>The EulerPC method is recommended as a fallback when other IRC methods have difficulty:</p>
        <ul>
          <li>When the default <a href="irc_gs.html">GS method</a>, <a href="irc_lqa.html">LQA</a>, or <a href="irc_hpc.html">HPC</a> fail to converge along the IRC path.</li>
          <li>For highly anharmonic reactions where the PES curvature changes drastically along the reaction coordinate.</li>
          <li>For reactions involving large-amplitude motions, bond breaking/forming events with flat or irregular PES regions.</li>
          <li>When path accuracy is more important than computational speed.</li>
        </ul>
        <p>For routine IRC calculations on well-behaved surfaces, the default <a href="irc_gs.html">GS method</a> or the faster <a href="irc_hpc.html">HPC method</a> are generally preferred.</p>

        <nav class="page-nav">
          <a href="irc_hpc.html">&larr; Previous: HPC</a>
          <a href="../../functions/solvent.html">Next: Solvation &rarr;</a>
        </nav>
      </article>
    </main>

    <aside class="toc"><div class="toc-sticky"><h3>On this page</h3><ul></ul></div></aside>
  </div>
  <div class="sidebar-overlay"></div>
  <footer><p>&copy; 2026, MAPLE development team.</p></footer>
  <script src="../../assets/js/main.js"></script>
</body>
</html>
