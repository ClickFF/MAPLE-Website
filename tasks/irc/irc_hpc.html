<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IRC: Hessian Predictor-Corrector (HPC) - MAPLE</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../../index.html"><img src="../../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../general.html">About</a></li>
          <li><a href="../../documentation.html">Documentation</a></li>
          <li><a href="../../articles.html">Articles</a></li>
          <li><a href="../../downloads.html">Downloads</a></li>
          <li><a href="../../development.html">Development</a></li>
          <li><a href="../../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../../tutorials/installation.html">Installation</a></li>
                <li><a href="../../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../../setup/settings.html">Settings</a></li>
                <li><a href="../../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../../tasks/frequency.html">Frequency</a></li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../opt/optimization.html">Optimization</a></span>
                  <ul class="children">
                    <li><a href="../opt/opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../opt/opt_rfo.html">RFO</a></li>
                    <li><a href="../opt/opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../ts/ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="../ts/ts_prfo.html">P-RFO</a></li>
                    <li><a href="../ts/ts_neb.html">NEB</a></li>
                    <li><a href="../ts/ts_dimmer.html">Dimer</a></li>
                    <li><a href="../ts/ts_string.html">String/GSM</a></li>
                    <li><a href="../ts/ts_autoneb.html">AutoNEB</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../scan/scan.html">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="../scan/scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../scan/scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li class="open">
                  <span class="tree-label"><span class="chevron"></span> <a href="irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="irc_gs.html">GS</a></li>
                    <li><a href="irc_lqa.html">LQA</a></li>
                    <li><a href="irc_hpc.html" class="active">HPC</a></li>
                    <li><a href="irc_eulerpc.html">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../../functions/solvent.html">Solvation</a></li>
                <li><a href="../../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../documentation.html">Docs</a></li>
          <li><a href="../../documentation.html">Tasks</a></li>
          <li><a href="irc.html">IRC</a></li>
          <li aria-current="page">HPC</li>
        </ol>
      </nav>

      <article>
        <h1>IRC: Hessian Predictor&ndash;Corrector (HPC)</h1>

        <h2 id="overview">Overview</h2>
        <p>The Hessian Predictor&ndash;Corrector (HPC) method is an IRC integration algorithm that uses Hessian information for both the predictor and corrector phases of each step. By incorporating second-derivative information into both phases, HPC achieves a good balance between computational speed and path accuracy, often converging with fewer total gradient evaluations than the GS method while maintaining high reliability.</p>

        <h2 id="algorithm">Algorithm</h2>
        <p>At each IRC step, the HPC method proceeds in two phases:</p>
        <ol>
          <li><strong>Predictor step</strong> &mdash; Using the current gradient and Hessian, the method performs a Hessian-based integration step along the steepest-descent direction in mass-weighted coordinates. The Hessian eigenvalues and eigenvectors are used to determine the optimal step direction, accounting for PES curvature.</li>
          <li><strong>Corrector step</strong> &mdash; After evaluating the actual energy and gradient at the predicted point, a correction is applied to bring the path back onto the true minimum energy path. The corrector uses both the gradient at the predicted point and the Hessian to compute the optimal correction direction.</li>
        </ol>
        <p>The Hessian is updated between steps using BFGS/Bofill update formulas to avoid expensive full Hessian recomputations at every IRC point.</p>

        <h2 id="parameters">Parameters</h2>
        <p>The complete <code>HPCParams</code> dataclass:</p>
        <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Parameter</th>
              <th>Type</th>
              <th>Default</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>target_mode</code></td>
              <td>int</td>
              <td>1</td>
              <td>Index of the imaginary mode to follow.</td>
            </tr>
            <tr>
              <td><code>step_length_bohr</code></td>
              <td>float</td>
              <td>0.10</td>
              <td>Step length in Bohr.</td>
            </tr>
            <tr>
              <td><code>max_steps</code></td>
              <td>int</td>
              <td>50</td>
              <td>Maximum IRC steps per direction.</td>
            </tr>
            <tr>
              <td><code>euler_n</code></td>
              <td>int</td>
              <td>5000</td>
              <td>Number of Euler sub-steps for the predictor.</td>
            </tr>
            <tr>
              <td><code>hessian_recalc</code></td>
              <td>int</td>
              <td>None</td>
              <td>Recalculate Hessian every N steps.</td>
            </tr>
            <tr>
              <td><code>hessian_update</code></td>
              <td>str</td>
              <td><code>"bofill"</code></td>
              <td>Hessian update: <code>"bfgs"</code> or <code>"bofill"</code>.</td>
            </tr>
            <tr>
              <td><code>dwi_n</code></td>
              <td>int</td>
              <td>4</td>
              <td>Number of distance-weighted interpolation points.</td>
            </tr>
            <tr>
              <td><code>mbs_max_k</code></td>
              <td>int</td>
              <td>15</td>
              <td>Maximum polynomial order for modified Bulirsch-Stoer.</td>
            </tr>
            <tr>
              <td><code>mbs_points</code></td>
              <td>int</td>
              <td>20</td>
              <td>Number of MBS integration points.</td>
            </tr>
            <tr>
              <td><code>mbs_tol</code></td>
              <td>float</td>
              <td>1e-5</td>
              <td>MBS convergence tolerance.</td>
            </tr>
            <tr>
              <td><code>f_max_th</code></td>
              <td>float</td>
              <td>2e-3</td>
              <td>Max force convergence threshold.</td>
            </tr>
            <tr>
              <td><code>f_rms_th</code></td>
              <td>float</td>
              <td>5e-4</td>
              <td>RMS force convergence threshold.</td>
            </tr>
            <tr>
              <td><code>print_each</code></td>
              <td>bool</td>
              <td>True</td>
              <td>Print details at each IRC point.</td>
            </tr>
            <tr>
              <td><code>write_traj</code></td>
              <td>bool</td>
              <td>True</td>
              <td>Write trajectory XYZ files.</td>
            </tr>
          </tbody>
        </table>
        </div>

        <h2 id="input-example">Input Example</h2>
        <pre><code>#model=ani1xnr
#irc(method=hpc)
#device=gpu0

XYZ /path/to/transition_state.xyz</code></pre>

        <h2 id="when-to-use">When to Use</h2>
        <p>The HPC method is recommended when:</p>
        <ul>
          <li>The default <a href="irc_gs.html">GS method</a> is too slow due to the number of corrector iterations required at each IRC point.</li>
          <li>You want a good balance between speed and accuracy without sacrificing robustness.</li>
          <li>The PES has moderate curvature changes along the reaction path, where Hessian-based integration provides a clear advantage over simpler gradient-only methods.</li>
        </ul>
        <p>For very smooth surfaces where maximum speed is desired, consider <a href="irc_lqa.html">LQA</a>. For extremely difficult or anharmonic surfaces where robustness is paramount, consider <a href="irc_eulerpc.html">EulerPC</a>.</p>

        <nav class="page-nav">
          <a href="irc_lqa.html">&larr; Previous: LQA</a>
          <a href="irc_eulerpc.html">Next: EulerPC &rarr;</a>
        </nav>
      </article>
    </main>

    <aside class="toc"><div class="toc-sticky"><h3>On this page</h3><ul></ul></div></aside>
  </div>
  <div class="sidebar-overlay"></div>
  <footer><p>&copy; 2026, MAPLE development team.</p></footer>
  <script src="../../assets/js/main.js"></script>
</body>
</html>
