<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vibrational Frequency Analysis - MAPLE</title>
  <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../index.html"><img src="../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="../general.html">About</a></li>
          <li><a href="../documentation.html">Documentation</a></li>
          <li><a href="../articles.html">Articles</a></li>
          <li><a href="../downloads.html">Downloads</a></li>
          <li><a href="../development.html">Development</a></li>
          <li><a href="../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../tutorials/installation.html">Installation</a></li>
                <li><a href="../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../setup/settings.html">Settings</a></li>
                <li><a href="../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../tasks/frequency.html" class="active">Frequency</a></li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/opt/optimization.html">Optimization</a></span>
                  <ul class="children">
                    <li><a href="../tasks/opt/opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../tasks/opt/opt_rfo.html">RFO</a></li>
                    <li><a href="../tasks/opt/opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/ts/ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="../tasks/ts/ts_prfo.html">P-RFO</a></li>
                    <li><a href="../tasks/ts/ts_neb.html">NEB</a></li>
                    <li><a href="../tasks/ts/ts_dimmer.html">Dimer</a></li>
                    <li><a href="../tasks/ts/ts_string.html">String/GSM</a></li>
                    <li><a href="../tasks/ts/ts_autoneb.html">AutoNEB</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/scan/scan.html">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="../tasks/scan/scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../tasks/scan/scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/irc/irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="../tasks/irc/irc_gs.html">GS</a></li>
                    <li><a href="../tasks/irc/irc_lqa.html">LQA</a></li>
                    <li><a href="../tasks/irc/irc_hpc.html">HPC</a></li>
                    <li><a href="../tasks/irc/irc_eulerpc.html">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../functions/solvent.html">Solvation</a></li>
                <li><a href="../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <nav class="breadcrumb">
        <a href="../index.html">Home</a>
        <span class="separator">/</span>
        <a href="../documentation.html">Docs</a>
        <span class="separator">/</span>
        <span>Tasks</span>
        <span class="separator">/</span>
        <span class="current">Frequency</span>
      </nav>

      <article>
        <h1>Vibrational Frequency Analysis</h1>

        <h2 id="overview">Overview</h2>
        <p>The frequency analysis module computes vibrational normal modes by constructing and diagonalizing the mass-weighted Hessian matrix (the matrix of second derivatives of the energy with respect to nuclear coordinates, weighted by atomic masses). Each eigenvalue corresponds to the square of a vibrational frequency, and each eigenvector defines a normal mode of vibration.</p>
        <p>From the computed normal mode frequencies, MAPLE derives thermochemical quantities using the rigid rotor-harmonic oscillator (RRHO) approximation, including zero-point vibrational energy (ZPVE), thermal corrections, enthalpy, entropy, and Gibbs free energy at the specified temperature and pressure.</p>

        <div class="admonition warning">
          <div class="admonition-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            Warning
          </div>
          <div class="admonition-body">
            <p>The input structure should be properly optimized before running a frequency analysis. Frequencies computed at non-stationary points are not physically meaningful and will not yield correct thermochemical data.</p>
          </div>
        </div>

        <h2 id="usage">Usage</h2>
        <p>The frequency analysis task is invoked by including the <code>#freq</code> header command in the input file:</p>
        <pre><code>#freq</code></pre>
        <p>When called without parameters, MAPLE uses the default settings: mass-weighted Hessian diagonalization at 298.15 K and 101.325 kPa (1 atm).</p>

        <h2 id="input-example">Input Example</h2>
        <p>Below is a complete input file for a frequency calculation on a previously optimized structure:</p>
        <pre><code>#model=ani1xnr
#freq
#device=gpu0

XYZ /path/to/optimized_structure.xyz</code></pre>
        <p>The <code>XYZ</code> directive reads atomic coordinates from an external file. This is convenient when using geometries produced by a prior optimization run.</p>

        <h2 id="parameters">Parameters</h2>
        <p>The following parameters can be adjusted for the frequency analysis task. Default values are shown.</p>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Default</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>method</code></td>
                <td>str</td>
                <td><code>mw</code></td>
                <td>Hessian diagonalization method: <code>mw</code> (mass-weighted), <code>nonmw</code> (unweighted), or <code>both</code>.</td>
              </tr>
              <tr>
                <td><code>temperature</code></td>
                <td>float</td>
                <td><code>298.15</code></td>
                <td>Temperature in Kelvin for thermochemical evaluation.</td>
              </tr>
              <tr>
                <td><code>ilowfreq</code></td>
                <td>int</td>
                <td><code>2</code></td>
                <td>Low-frequency treatment: 0 = RRHO (no special treatment), 1 = Truhlar quasi-harmonic, 2 = Grimme quasi-RRHO, 3 = Minenkov interpolation.</td>
              </tr>
              <tr>
                <td><code>verbose</code></td>
                <td>int</td>
                <td><code>1</code></td>
                <td>Output verbosity level.</td>
              </tr>
              <tr>
                <td><code>treat_imag_as_real</code></td>
                <td>bool</td>
                <td><code>false</code></td>
                <td>Treat imaginary frequencies as real for thermochemistry.</td>
              </tr>
              <tr>
                <td><code>pressure_kpa</code></td>
                <td>float</td>
                <td><code>101.325</code></td>
                <td>Pressure in kPa (101.325 = 1 atm).</td>
              </tr>
              <tr>
                <td><code>device</code></td>
                <td>str</td>
                <td><code>cpu</code></td>
                <td>Compute device for Hessian evaluation.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h2 id="output">Output</h2>
        <p>The frequency analysis output file reports the following quantities:</p>
        <ul>
          <li><strong>Normal mode frequencies</strong> -- all 3N-6 (or 3N-5 for linear molecules) vibrational frequencies in cm<sup>-1</sup>. Imaginary frequencies are printed as negative values.</li>
          <li><strong>Zero-point vibrational energy (ZPVE)</strong> -- the sum of half-quanta for all real vibrational modes, reported in Hartree and kcal/mol.</li>
          <li><strong>Thermal corrections</strong> -- contributions from translational, rotational, and vibrational degrees of freedom at the specified temperature.</li>
          <li><strong>Enthalpy (H)</strong> -- total enthalpy including electronic energy, ZPVE, and thermal corrections.</li>
          <li><strong>Entropy (S)</strong> -- total entropy from translational, rotational, vibrational, and electronic partition functions.</li>
          <li><strong>Gibbs free energy (G)</strong> -- computed as G = H - TS at the specified temperature.</li>
        </ul>

        <div class="admonition important">
          <div class="admonition-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            Important
          </div>
          <div class="admonition-body">
            <p>Imaginary frequencies (printed as negative values) indicate that the structure is not a true minimum. One imaginary frequency corresponds to a transition state; multiple imaginary frequencies suggest the structure is a higher-order saddle point or has not been properly optimized. Re-optimize the structure before repeating the frequency analysis.</p>
          </div>
        </div>

        <h2 id="thermochemistry">Thermochemistry</h2>
        <p>MAPLE evaluates thermochemical properties using the rigid rotor-harmonic oscillator (RRHO) approximation, which partitions the molecular partition function into independent contributions:</p>
        <ul>
          <li><strong>Translational partition function</strong> -- derived from the ideal gas model, depends on molecular mass, temperature, and pressure.</li>
          <li><strong>Rotational partition function</strong> -- computed from the principal moments of inertia assuming a rigid rotor, with separate handling for linear and nonlinear molecules.</li>
          <li><strong>Vibrational partition function</strong> -- each normal mode is treated as an independent quantum harmonic oscillator. Modes below the <code>ilowfreq</code> threshold are handled with a free-rotor interpolation to avoid numerical instability.</li>
          <li><strong>Electronic partition function</strong> -- assumes the electronic ground state dominates (multiplicity = 1 for closed-shell systems).</li>
        </ul>
        <p>The total internal energy, enthalpy, entropy, and Gibbs free energy are assembled from these partition function components. All thermochemical values are reported at the user-specified temperature and pressure.</p>

        <nav class="page-nav">
          <a href="../tasks/singlepoint.html">&larr; Prev: Single Point</a>
          <a class="next" href="../tasks/opt/optimization.html">Next: Optimization &rarr;</a>
        </nav>
      </article>
    </main>

    <aside class="toc">
      <div class="toc-sticky">
        <h3>On this page</h3>
        <ul></ul>
      </div>
    </aside>
  </div>
  <div class="sidebar-overlay"></div>
  <footer><p>&copy; 2026, MAPLE development team.</p></footer>
  <script src="../assets/js/main.js"></script>
</body>
</html>
