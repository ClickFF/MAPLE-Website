<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PES Scan - MAPLE</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../../index.html"><img src="../../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../general.html">About</a></li>
          <li><a href="../../documentation.html">Documentation</a></li>
          <li><a href="../../articles.html">Articles</a></li>
          <li><a href="../../downloads.html">Downloads</a></li>
          <li><a href="../../development.html">Development</a></li>
          <li><a href="../../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../../tutorials/installation.html">Installation</a></li>
                <li><a href="../../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../../setup/settings.html">Settings</a></li>
                <li><a href="../../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../../tasks/frequency.html">Frequency</a></li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../opt/optimization.html">Optimization</a></span>
                  <ul class="children">
                    <li><a href="../opt/opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../opt/opt_rfo.html">RFO</a></li>
                    <li><a href="../opt/opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../ts/ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="../ts/ts_prfo.html">P-RFO</a></li>
                    <li><a href="../ts/ts_neb.html">NEB</a></li>
                    <li><a href="../ts/ts_dimmer.html">Dimer</a></li>
                    <li><a href="../ts/ts_string.html">String/GSM</a></li>
                    <li><a href="../ts/ts_autoneb.html">AutoNEB</a></li>
                  </ul>
                </li>
                <li class="open">
                  <span class="tree-label"><span class="chevron"></span> <a href="scan.html" class="active">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../irc/irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="../irc/irc_gs.html">GS</a></li>
                    <li><a href="../irc/irc_lqa.html">LQA</a></li>
                    <li><a href="../irc/irc_hpc.html">HPC</a></li>
                    <li><a href="../irc/irc_eulerpc.html">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../../functions/solvent.html">Solvation</a></li>
                <li><a href="../../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol>
          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../documentation.html">Docs</a></li>
          <li><a href="../../documentation.html">Tasks</a></li>
          <li aria-current="page">PES Scan</li>
        </ol>
      </nav>

      <article>
        <h1>Potential Energy Surface Scanning</h1>

        <h2 id="overview">Overview</h2>
        <p>The PES Scan module performs systematic exploration of the potential energy surface along user-specified internal coordinates. It supports one-dimensional (1D), two-dimensional (2D), and arbitrary N-dimensional scans. Two scan modes are available: <strong>relaxed</strong> scans, where all coordinates except the scanned ones are optimized at each step, and <strong>rigid</strong> scans, where all other coordinates are frozen at their initial values.</p>
        <p>PES scans are commonly used for constructing torsional energy profiles, mapping bond-dissociation curves, exploring conformational landscapes, and generating starting geometries for transition-state searches.</p>

        <h2 id="scan-coordinate-syntax">Scan Coordinate Syntax</h2>
        <p>Scan coordinates are specified with the <code>S</code> command at the end of the input file, after the molecular geometry. The format depends on the type of internal coordinate being scanned:</p>
        <ul>
          <li><strong>Distance scan (2 atoms):</strong> <code>S atom1 atom2 step_size n_steps</code></li>
          <li><strong>Angle scan (3 atoms):</strong> <code>S atom1 atom2 atom3 step_size n_steps</code></li>
          <li><strong>Dihedral scan (4 atoms):</strong> <code>S atom1 atom2 atom3 atom4 step_size n_steps</code></li>
        </ul>
        <p>Where:</p>
        <ul>
          <li><strong>atom1</strong>, <strong>atom2</strong>, ... &mdash; 1-based atom indices defining the internal coordinate to scan.</li>
          <li><strong>step_size</strong> &mdash; increment per step (in Angstroms for bonds, degrees for angles/dihedrals). Negative values scan in the decreasing direction.</li>
          <li><strong>n_steps</strong> &mdash; number of scan steps to perform.</li>
        </ul>

        <h2 id="scan-modes">Scan Modes</h2>
        <p>MAPLE supports two scan modes, selected via the <code>mode</code> parameter in the <code>#scan</code> header:</p>
        <table>
          <thead>
            <tr>
              <th>Mode</th>
              <th>Description</th>
              <th>Use Case</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>relaxed</strong></td>
              <td>Optimizes all degrees of freedom except the scanned coordinates at each scan point. Produces a minimum-energy path along the scan coordinate.</td>
              <td>Torsional profiles, bond dissociation curves, conformational analysis.</td>
            </tr>
            <tr>
              <td><strong>rigid</strong></td>
              <td>Freezes all coordinates at their initial values; only the scanned coordinate changes. No geometry optimization is performed.</td>
              <td>Quick energy profiles, repulsive wall scans, initial survey of PES topology.</td>
            </tr>
          </tbody>
        </table>

        <h2 id="input-example">Input Example</h2>
        <p>A simple 1D relaxed bond scan between atoms 1 and 2:</p>
        <pre><code>#model=uma
#scan
#device=gpu0

C   0.0  0.0  0.0
H   1.0  0.0  0.0
O   2.0  0.0  0.0

S 1 2 -0.1 15</code></pre>
        <p>This performs 15 steps along the C&ndash;H bond, decreasing the distance by 0.1 &Aring; at each step. Since no method is specified, the default L-BFGS optimizer is used for relaxed optimization at each scan point.</p>

        <h2 id="2d-scan-example">2D Scan Example</h2>
        <p>To scan two coordinates simultaneously, specify multiple <code>S</code> lines. MAPLE constructs the full Cartesian-product grid of scan points:</p>
        <pre><code>S 1 2 -0.1 15
S 2 3 -0.05 10</code></pre>
        <p>This produces a 15 &times; 10 = 150 grid of scan points. At each point, both scanned coordinates are constrained to their target values and all remaining degrees of freedom are optimized.</p>

        <h2 id="scan-settings">Scan Settings</h2>
        <p>The scan mode and optimizer are set via the <code>#scan</code> header line:</p>
        <pre><code>#scan(mode=relaxed)
#scan(mode=rigid)</code></pre>
        <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Parameter</th>
              <th>Type</th>
              <th>Default</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>mode</code></td>
              <td>str</td>
              <td><code>"relaxed"</code></td>
              <td>Scan mode: <code>"relaxed"</code> (optimize at each point) or <code>"rigid"</code> (freeze all other coordinates).</td>
            </tr>
            <tr>
              <td><code>method</code></td>
              <td>str</td>
              <td><code>"lbfgs"</code></td>
              <td>Optimizer for relaxed scans. Valid: <code>"lbfgs"</code>, <code>"cg"</code>.</td>
            </tr>
          </tbody>
        </table>
        </div>
        <div class="admonition note">
          <p class="admonition-title">Note</p>
          <p>During relaxed scans, the L-BFGS optimizer uses the following hardcoded defaults: <code>memory=5</code>, <code>curvature=70</code>, <code>max_step=0.2</code>, <code>max_iter=128</code>. These are not the same as the optimization task L-BFGS parameters and cannot be overridden from the input file.</p>
        </div>

        <h2 id="output-files">Output Files</h2>
        <p>The scan module produces the following output files:</p>
        <ul>
          <li><strong><code>*_scan_final.xyz</code></strong> &mdash; Multi-frame XYZ file containing the optimized geometry at each scan point. Can be visualized as a trajectory in standard molecular viewers.</li>
          <li><strong><code>*.out</code></strong> &mdash; Main text output with convergence diagnostics, energies, and coordinates for every scan point.</li>
        </ul>
        <p>The scan trajectory file uses the standard multi-frame XYZ format, with one frame per converged scan point. Each frame header includes the scan combination index and the target values of the scanned internal coordinates.</p>

        <nav class="page-nav">
          <a href="../ts/ts_autoneb.html">&larr; Previous: AutoNEB</a>
          <a href="scan_lbfgs.html">Next: Scan L-BFGS &rarr;</a>
        </nav>
      </article>
    </main>

    <aside class="toc"><div class="toc-sticky"><h3>On this page</h3><ul></ul></div></aside>
  </div>
  <div class="sidebar-overlay"></div>
  <footer><p>&copy; 2026, MAPLE development team.</p></footer>
  <script src="../../assets/js/main.js"></script>
</body>
</html>
