<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solvation - MAPLE Documentation</title>
  <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
  <header class="top-nav">
    <div class="container">
      <div class="brand">
        <a href="../index.html"><img src="../assets/images/logo.jpg" alt="MAPLE Logo"></a>
        <a href="../index.html">MAPLE</a>
      </div>
      <button class="mobile-toggle" aria-label="Toggle menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <nav>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="../general.html">About</a></li>
          <li><a href="../documentation.html">Documentation</a></li>
          <li><a href="../articles.html">Articles</a></li>
          <li><a href="../downloads.html">Downloads</a></li>
          <li><a href="../development.html">Development</a></li>
          <li><a href="../issues.html">Report Issue</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="page-layout">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-brand">
          <img src="../assets/images/logo.jpg" alt="MAPLE">
          <span>MAPLE Docs</span>
        </div>
        <div class="sidebar-tree">
          <ul>
            <li>
              <span class="tree-section"><span class="chevron"></span> Getting Started</span>
              <ul class="children">
                <li><a href="../tutorials/installation.html">Installation</a></li>
                <li><a href="../tutorials/quickstart.html">Quick Start</a></li>
                <li><a href="../tutorials/input_output.html">Input &amp; Output</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Input Setup</span>
              <ul class="children">
                <li><a href="../setup/settings.html">Settings</a></li>
                <li><a href="../setup/coordinates.html">Coordinates</a></li>
                <li><a href="../setup/models.html">ML Models</a></li>
              </ul>
            </li>
            <li>
              <span class="tree-section"><span class="chevron"></span> Tasks</span>
              <ul class="children">
                <li><a href="../tasks/singlepoint.html">Single Point</a></li>
                <li><a href="../tasks/frequency.html">Frequency</a></li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/opt/optimization.html">Optimization</a></span>
                  <ul class="children">
                    <li><a href="../tasks/opt/opt_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../tasks/opt/opt_rfo.html">RFO</a></li>
                    <li><a href="../tasks/opt/opt_sd.html">SD</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/ts/ts.html">Transition State</a></span>
                  <ul class="children">
                    <li><a href="../tasks/ts/ts_prfo.html">P-RFO</a></li>
                    <li><a href="../tasks/ts/ts_neb.html">NEB</a></li>
                    <li><a href="../tasks/ts/ts_dimmer.html">Dimer</a></li>
                    <li><a href="../tasks/ts/ts_string.html">String/GSM</a></li>
                    <li><a href="../tasks/ts/ts_autoneb.html">AutoNEB</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/scan/scan.html">PES Scan</a></span>
                  <ul class="children">
                    <li><a href="../tasks/scan/scan_lbfgs.html">L-BFGS</a></li>
                    <li><a href="../tasks/scan/scan_rfo.html">RFO</a></li>
                  </ul>
                </li>
                <li>
                  <span class="tree-label"><span class="chevron"></span> <a href="../tasks/irc/irc.html">IRC</a></span>
                  <ul class="children">
                    <li><a href="../tasks/irc/irc_gs.html">GS</a></li>
                    <li><a href="../tasks/irc/irc_lqa.html">LQA</a></li>
                    <li><a href="../tasks/irc/irc_hpc.html">HPC</a></li>
                    <li><a href="../tasks/irc/irc_eulerpc.html">EulerPC</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li class="open">
              <span class="tree-section"><span class="chevron"></span> Functions</span>
              <ul class="children">
                <li><a href="../functions/solvent.html" class="active">Solvation</a></li>
                <li><a href="../functions/constrain.html">Constraints</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="content">
      <nav class="breadcrumb">
        <a href="../index.html">Home</a>
        <span class="separator">/</span>
        <a href="../documentation.html">Docs</a>
        <span class="separator">/</span>
        <span>Functions</span>
        <span class="separator">/</span>
        <span class="current">Solvation</span>
      </nav>
      <article>
        <h1>Solvation</h1>

        <p>The Solv module in MAPLE incorporates solvent effects into calculations, transitioning from ideal gas-phase conditions to more realistic solution-phase environments. It offers two complementary approaches: an implicit solvent model based on geometry-dependent Born radii (GBSA) and an explicit solvation method that places solvent molecules around the solute from pre-built crystal box templates. Both methods can be combined to capture long-range dielectric effects alongside localized solvation phenomena such as hydrogen bonding.</p>

        <h2 id="gbsa">GBSA Implicit Solvation</h2>

        <p>The Generalized Born with Solvent-Accessible Surface Area (GBSA) model is an implicit solvation method that represents the solvent as a continuous dielectric medium rather than discrete molecules. It accounts for two main contributions to the solvation free energy:</p>

        <ul>
          <li><strong>Electrostatic component (GB):</strong> Coulombic interactions between atomic partial charges are screened by the dielectric constant of the solvent. Geometry-dependent Born radii are computed for each atom to model the effective distance from the solute-solvent boundary.</li>
          <li><strong>Non-polar component (SA):</strong> The solvent-accessible surface area is used to estimate the cavitation and van der Waals contributions to the solvation free energy.</li>
        </ul>

        <p>When GBSA is enabled, atomic partial charges are automatically computed using the charge equilibration (QEq) method. These charges are then used in the GB energy evaluation.</p>

        <pre><code>#model = uma
#solv(implicit=gbsa)
#opt</code></pre>

        <h2 id="configuration">Parameters</h2>

        <p>The <code>#solv</code> command accepts several parameters to control the solvation setup. Parameters are passed in parentheses, separated by commas.</p>

        <table>
          <thead>
            <tr>
              <th>Parameter</th>
              <th>Default</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>implicit</code></td>
              <td><code>None</code></td>
              <td>Set to <code>gbsa</code> to enable the GBSA implicit solvent model</td>
            </tr>
            <tr>
              <td><code>explicit</code></td>
              <td><code>None</code></td>
              <td>Solvent name for explicit solvation (e.g., <code>water</code>, <code>methanol</code>)</td>
            </tr>
            <tr>
              <td><code>radius</code></td>
              <td><code>10.0</code></td>
              <td>Radius of the solvation shell around the solute, in Angstroms</td>
            </tr>
            <tr>
              <td><code>clash_cutoff</code></td>
              <td><code>1.5</code></td>
              <td>Minimum distance between solvent and solute atoms; closer molecules are removed (Angstroms)</td>
            </tr>
            <tr>
              <td><code>fix_dis</code></td>
              <td><code>8.0</code></td>
              <td>Distance threshold beyond which solvent molecules are frozen in place (Angstroms)</td>
            </tr>
          </tbody>
        </table>

        <h2 id="supported-solvents">Supported Solvents</h2>

        <h3>Implicit Solvent Models (GBSA)</h3>
        <p>The following solvents are available for implicit GBSA solvation, each with a calibrated dielectric constant:</p>
        <ul class="column-list">
          <li>acetone</li>
          <li>acetonitrile</li>
          <li>benzene</li>
          <li>cs2</li>
          <li>dichloromethane</li>
          <li>dmf</li>
          <li>dmso</li>
          <li>ether</li>
          <li>methanol</li>
          <li>nhexan</li>
          <li>thf</li>
          <li>toluene</li>
          <li>trichloromethane</li>
          <li>water</li>
        </ul>

        <h3>Explicit Solvent Templates</h3>
        <p>A broad set of explicit solvent templates is available, built from pre-equilibrated crystal box structures. Some commonly used solvents include:</p>
        <ul class="column-list">
          <li>water</li>
          <li>methanol</li>
          <li>ethanol</li>
          <li>acetone</li>
          <li>acetonitrile</li>
          <li>benzene</li>
          <li>chloroform</li>
          <li>cyclohexane</li>
          <li>dichloroethane</li>
          <li>diethylether</li>
          <li>dimethylformamide</li>
          <li>dimethylsulfoxide</li>
          <li>heptane</li>
          <li>hexane</li>
          <li>isopropanol</li>
          <li>methylenechloride</li>
          <li>octane</li>
          <li>pentane</li>
          <li>pyridine</li>
          <li>tetrahydrofuran</li>
          <li>toluene</li>
          <li>xylene</li>
        </ul>
        <p>Over 80 additional organic solvents are available. See the MAPLE distribution for the complete list of PDB templates in the solvent library.</p>

        <h2 id="explicit-solvation">Explicit Solvation</h2>

        <p>Explicit solvation places individual solvent molecules around the solute using pre-built crystal box templates. The process works as follows:</p>

        <ol>
          <li>A solvent crystal box (PDB template) is loaded for the chosen solvent.</li>
          <li>The box is replicated to fill a sphere of the specified <code>radius</code> around the solute center of mass.</li>
          <li>Solvent molecules whose atoms are closer than <code>clash_cutoff</code> to any solute atom are removed.</li>
          <li>Solvent molecules farther than <code>fix_dis</code> from the solute center are frozen in place, while inner-shell solvent molecules remain free to relax.</li>
        </ol>

        <pre><code>#model = uma
#solv(explicit=water, radius=12.0, clash_cutoff=1.5, fix_dis=8.0)
#opt(method=lbfgs)</code></pre>

        <div class="admonition tip">
          <p class="admonition-title">Tip</p>
          <p>You can combine implicit and explicit solvation in the same calculation. The implicit GBSA correction is applied to the entire system (solute + explicit solvent), which can help capture long-range dielectric effects beyond the explicit solvation shell.</p>
        </div>

        <h2 id="usage-example">Usage Example</h2>

        <p>The following is a complete MAPLE input file demonstrating solvation for an acetaldehyde optimization in implicit water:</p>

        <pre><code>#model = uma
#device = gpu0
#solv(implicit=gbsa)
#opt(method=lbfgs, convergence=tight)

0 1
C    0.000000    0.000000    0.000000
C    1.501000    0.000000    0.000000
O    2.098000    1.060000    0.000000
H   -0.392000    1.011000    0.000000
H   -0.392000   -0.506000    0.875000
H   -0.392000   -0.506000   -0.875000
H    1.960000   -1.003000    0.000000</code></pre>

        <p>For explicit solvation with water, with outer molecules frozen:</p>

        <pre><code>#model = uma
#device = gpu0
#solv(explicit=water, radius=10.0, clash_cutoff=1.5, fix_dis=8.0)
#opt(method=lbfgs, convergence=medium)

0 1
C    0.000000    0.000000    0.000000
C    1.501000    0.000000    0.000000
O    2.098000    1.060000    0.000000
H   -0.392000    1.011000    0.000000
H   -0.392000   -0.506000    0.875000
H   -0.392000   -0.506000   -0.875000
H    1.960000   -1.003000    0.000000</code></pre>

        <p>And combined implicit + explicit solvation:</p>

        <pre><code>#model = uma
#device = gpu0
#solv(implicit=gbsa, explicit=water, radius=12.0, clash_cutoff=1.5, fix_dis=8.0)
#opt(method=lbfgs)

XYZ /path/to/solute.xyz</code></pre>

      </article>
      <nav class="page-nav">
        <a class="prev" href="../tasks/irc/irc_eulerpc.html">&larr; Previous: EulerPC</a>
        <a class="next" href="../functions/constrain.html">Next: Constraints &rarr;</a>
      </nav>
    </main>

    <aside class="toc">
      <div class="toc-sticky">
        <h3>On this page</h3>
        <ul>
          <li><a href="#gbsa">GBSA Implicit Solvation</a></li>
          <li><a href="#configuration">Parameters</a></li>
          <li><a href="#supported-solvents">Supported Solvents</a></li>
          <li><a href="#explicit-solvation">Explicit Solvation</a></li>
          <li><a href="#usage-example">Usage Example</a></li>
        </ul>
      </div>
    </aside>
  </div>

  <div class="sidebar-overlay"></div>
  <footer>
    <p>&copy; 2026, MAPLE development team.</p>
  </footer>
  <script src="../assets/js/main.js"></script>
</body>
</html>
